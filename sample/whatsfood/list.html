<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Whatsfood</title>
		<link rel="stylesheet" href="css/whatsfood.min.css" />
		<link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile.structure-1.3.2.min.css" />
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css" rel="stylesheet">
		<link href="http://netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
		<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
		<script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
		<script>
			$(document).on('pagebeforeshow', '#keelung', function(){      
	        	// $.ajax({url: "http://www.ipeen.com.tw/search/keelung/000/0-100-0-0/?so=sat",
		        //     dataType: "jsonp",
		        //     async: true,
		        //     success: function (result) {
		        //         ajax.parseJSONP(result);
		        //     },
		        //     error: function (request, error) {
		        //         alert('Network error has occurred please try again!');
		        //     }
		        // });  
		        $.getJSON("http://query.yahooapis.com/v1/public/yql?q=%20select%20*%20from%20html%20where%20url%3D%22http%3A%2F%2Fwww.ipeen.com.tw%2Fsearch%2Fkeelung%2F000%2F0-100-0-0%2F%3Fso%3Dsat%22%20and%20xpath%3D%22%2F%2F*%5B%40class%3D'result'%5D%22%20&format=json&diagnostics=true&callback=",function(data){

		        	$.each(data.query.results.div.div, function(i){
		        		//console.log(i);
		        		//console.log(row);
		        		//console.log(data.query.results.div.div[i].class);
		        		if(data.query.results.div.div[i].class === 'serShop'){
		        			console.log(i);
		        			console.log(data.query.results.div.div[i]);
		        			console.log(data.query.results.div.div[i].div[1]);
		        			//data -> serShop ->  serImg/setData 

		        			var title = data.query.results.div.div[i].h3.a.content;
		        			var img = data.query.results.div.div[i].div[0].div.
		        				a.img.src;
		        			var link = data.query.results.div.div[i].h3.a.href;
		        			var rank = data.query.results.div.div[i].div[1].ul[1].li[0].img.alt;
		        			$('#movie-data').append('<li>' + '<a href="#' + link + '">' + '<img src="' + img + '">' + '<h2>' + title + '</h2>' + '<p>' + rank + '</p>' + '</a>' + '</li>');
		        			$('#movie-data').listview('refresh');
		 //        			<div data-demo-html="true">
			// 	<ul data-role="listview" data-inset="true">
			// 		<li><a href="#">
			// 			<img src="../../_assets/img/album-bb.jpg" />
			// 			<h2>Broken Bells</h2>
			// 			<p>Broken Bells</p></a>
			// 		</li>
			// 		<li><a href="#">
			// 			<img src="../../_assets/img/album-hc.jpg" />
			// 			<h2>Warning</h2>
			// 			<p>Hot Chip</p></a>
			// 		</li>
			// 		<li><a href="#">
			// 			<img src="../../_assets/img/album-p.jpg" />
			// 			<h2>Wolfgang Amadeus Phoenix</h2>
			// 			<p>Phoenix</p></a>
			// 		</li>
			// 	</ul>
			// </div><!--/demo-html -->
			        	}
		        	});
		        });      
		    });
			
			function addBtn(){
				var btnIndex=$('#buttonList').children().length;
				$('#buttonList').append('<button data-theme="b" value="動態產生的按鈕'+(++btnIndex)+'" ></button>');
					$('#index').trigger('create');
			}
    
		    // var ajax = {  
		    //     parseJSONP:function(result){
		    //     	console.log(result);
		    //         $.each(result, function(i, row) {
		    //             $('#movie-data').append('');
		                
		    //         });
		    //         $('#movie-data').listview('refresh');
		    //     }
		    // }

		</script>
	</head>
	<body>
		<div data-role="page" data-theme="c">
			<!-- Left Panel -->
			<div data-role="panel" id="left-panel" data-position="left" data-display="push">
				<ul>
					<li><a href="">台北市</a></li>
					<li><a href="#keelung">基隆市</a></li>
				</ul>
			</div>
			<!-- Right Panel -->
			<div data-role="panel" id="right-panel" data-position="right" data-display="push">
				<ul>
					<li>台北市</li>
					<li>基隆市</li>
				</ul>
			</div>
			<!-- Main Content -->
			<div data-role="header" data-position-fixed="true" data-theme="c">
				<a class="btn" href="#left-panel"><i class="icon-align-justify icon-large"></i></a>
				<h1>Whatsfood</h1>
				<a class="btn" href="#right-panel"><i class="icon-search icon-large"></i></a>
			</div>
			<div data-role="content" data-theme="c">
				<h2>今天想吃什麼呢？</h2>
				<p><i class="icon-camera-retro icon-4x"></i></p>
				<form action="" name="search-food">
					<input type="text" name="keyword" id="">
					<select name="" id="">
						<option value="taipei">台北市</option>
					</select>
					<button type="submit">送出</button>
				</form>
				<a id="go" href="./list.html">GOO</a>
			</div>
        </div>
		<div id="keelung" data-role="page" data-theme="c">
			<!-- Left Panel -->
			<div data-role="panel" id="left-panel" data-position="left" data-display="push">
				<ul>
					<li><a href="">台北市</a></li>
					<li><a href="#keelung">基隆市</a></li>
				</ul>
			</div>
			<!-- Right Panel -->
			<div data-role="panel" id="right-panel" data-position="right" data-display="push">
				<ul>
					<li>台北市</li>
					<li>基隆市</li>
				</ul>
			</div>
			<!-- Main Content -->
			<div data-role="header" data-position-fixed="true" data-theme="c">
				<a class="btn" href="#left-panel"><i class="icon-align-justify icon-large"></i></a>
				<h1>Whatsfood</h1>
				<a class="btn" href="#right-panel"><i class="icon-search icon-large"></i></a>
			</div>
			<div data-role="content" data-theme="c">
				<ul data-role="listview" id="movie-data" data-theme="a"></ul> 
			</div>
        </div>
	</body>
</html>